jQuery(function(i){function t(i){var t=this;this.$element=i,this.$content=i.find("div.item-data"),this.$discount=this.$content.find(".discount"),this.$visibility=this.$content.find(".item_visibility"),this.$price_visibility=this.$content.find(".price_visibility"),this.$allowed_variations=this.$content.find("div.allowed_variations"),this.$default_variation_attributes=this.$content.find("div.default_variation_attributes"),this.$custom_title=this.$content.find("div.custom_title"),this.$custom_description=this.$content.find("div.custom_description"),this.$override_title=this.$content.find(".override_title"),this.$override_description=this.$content.find(".override_description"),this.$hide_thumbnail=this.$content.find(".hide_thumbnail"),this.$section_links=this.$content.find(".subsubsub a"),this.$sections=this.$content.find(".options_group"),this.$priced_individually_input=this.$content.find(".priced_individually input"),this.$override_variations_input=this.$content.find(".override_variations input"),this.$override_defaults_input=this.$content.find(".override_default_variation_attributes input"),this.$override_title_input=this.$override_title.find("input"),this.$override_description_input=this.$override_description.find("input"),this.$price_visibility_product_input=this.$price_visibility.find("input.price_visibility_product"),this.$price_visibility_cart_input=this.$price_visibility.find("input.price_visibility_cart"),this.$price_visibility_order_input=this.$price_visibility.find("input.price_visibility_order"),this.$visibility_product_input=this.$visibility.find("input.visibility_product"),this.$visibility_cart_input=this.$visibility.find("input.visibility_cart"),this.$visibility_order_input=this.$visibility.find("input.visibility_order"),this.priced_individually_input_changed=function(){t.$priced_individually_input.is(":checked")?(t.$discount.show(),t.$price_visibility.show()):(t.$discount.hide(),t.$price_visibility.hide())},this.override_variations_input_changed=function(){t.$override_variations_input.is(":checked")?t.$allowed_variations.show():t.$allowed_variations.hide()},this.override_defaults_input_changed=function(){t.$override_defaults_input.is(":checked")?t.$default_variation_attributes.show():t.$default_variation_attributes.hide()},this.override_title_input_changed=function(){t.$override_title_input.is(":checked")?t.$custom_title.show():t.$custom_title.hide()},this.override_description_input_changed=function(){t.$override_description_input.is(":checked")?t.$custom_description.show():t.$custom_description.hide()},this.visibility_product_input_changed=function(){t.$visibility_product_input.is(":checked")?(t.$override_title.show(),t.$override_description.show(),t.$hide_thumbnail.show(),t.override_title_input_changed(),t.override_description_input_changed()):(t.$override_title.hide(),t.$override_description.hide(),t.$hide_thumbnail.hide(),t.$custom_description.hide(),t.$custom_title.hide())},this.toggled_visibility=function(i){t["$visibility_"+i+"_input"].is(":checked")?t["$price_visibility_"+i+"_input"].css("opacity",1):t["$price_visibility_"+i+"_input"].css("opacity",.5)},this.section_changed=function(i){t.$section_links.removeClass("current"),i.addClass("current"),t.$sections.addClass("options_group_hidden"),t.$content.find(".options_group_"+i.data("tab")).removeClass("options_group_hidden")},this.initialize=function(){t.priced_individually_input_changed(),t.override_variations_input_changed(),t.override_defaults_input_changed(),t.override_title_input_changed(),t.override_description_input_changed(),t.visibility_product_input_changed(),t.toggled_visibility("product"),t.toggled_visibility("cart"),t.toggled_visibility("order")},this.initialize()}function e(){_.length>0?(s.removeClass("no-items"),c.removeClass("disabled")):(s.addClass("no-items"),c.addClass("disabled"))}var n=i("p._wc_pb_edit_in_cart_field"),d=i("select#_wc_pb_group_mode"),o=i("#bundled_product_data"),s=o.find(".wc-metaboxes-wrapper"),c=o.find(".toolbar"),a=i(".wc-bundled-items"),_=i(".wc-bundled-item",a),r=i("#bundled_product",o),l={},u=_.length,p={message:null,overlayCSS:{background:"#fff",opacity:.6}};i.fn.wc_bundles_select2=function(){i(document.body).trigger("wc-enhanced-select-init")},i(".bundle_stock_msg").appendTo("._manage_stock_field .description"),i("#_sold_individually").closest(".form-field").addClass("hide_if_bundle"),i("#linked_product_data .grouping.show_if_simple, #linked_product_data .form-field.show_if_grouped").addClass("hide_if_bundle"),i(".show_if_simple:not(.hide_if_bundle)").addClass("show_if_bundle"),i("body").on("woocommerce-product-type-change",function(t,e){"bundle"===e&&(i(".show_if_external").hide(),i(".show_if_bundle").show(),i("input#_manage_stock").change(),i("#_nyp").change())}),d.change(function(){-1===i.inArray(d.val(),wc_bundles_admin_params.group_modes_with_parent)?n.hide():n.show()}),i("input#_downloadable").change(function(){i("select#product-type").change()}),i("select#product-type").change(),d.change(),r.on("change",function(){var e=r.val(),n=!!(e&&e.length>0)&&e.shift();if(!n)return!1;r.val([]).change(),o.block(p),u++;var d={action:"woocommerce_add_bundled_product",post_id:woocommerce_admin_meta_boxes.post_id,id:u,product_id:n,security:wc_bundles_admin_params.add_bundled_product_nonce};return setTimeout(function(){i.post(woocommerce_admin_meta_boxes.ajax_url,d,function(e){if(""!==e.markup){a.append(e.markup);var n=i(".wc-bundled-item",a).last(),d="bundled_item_"+u;n.data("bundled_item_id",d),l[d]=new t(n),o.triggerHandler("wc-bundled-products-changed"),n.find(".woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200}),n.wc_bundles_select2(),o.trigger("wc-bundles-added-bundled-product")}else""!==e.message&&window.alert(e.message);"yes"===wc_bundles_admin_params.is_wc_version_gte_3_2?(r.selectWoo("open"),r.selectWoo("close")):(r.select2("open"),r.select2("close")),o.unblock()})},250),!1}),s.on("click",".expand_all",function(){return!i(this).hasClass("disabled")&&(i.each(l,function(i,t){t.$element.addClass("open").removeClass("closed")}),!1)}).on("click",".close_all",function(){return!i(this).hasClass("disabled")&&(i.each(l,function(i,t){t.$element.addClass("closed").removeClass("open")}),!1)}),o.on("wc-bundled-products-changed",function(){(_=i(".wc-bundled-item",a)).each(function(t,e){i(".item_menu_order",e).val(t)}),e()}).one("wc-bundles-added-bundled-product",function(){s.removeClass("wc-bundle-metaboxes-wrapper--boarding")}),a.on("click","a.remove_row",function(t){var e=i(this).closest(".wc-bundled-item"),n=e.data("bundled_item_id");e.find("*").off(),e.remove(),delete l[n],o.triggerHandler("wc-bundled-products-changed"),t.preventDefault()}).on("change",".priced_individually input",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[t].priced_individually_input_changed()}).on("change",".override_variations input",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[t].override_variations_input_changed()}).on("change",".override_default_variation_attributes input",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[t].override_defaults_input_changed()}).on("change",".override_title input",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[t].override_title_input_changed()}).on("change",".override_description input",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[t].override_description_input_changed()}).on("change","input.visibility_product",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id"),e=l[t];e.visibility_product_input_changed(),e.toggled_visibility("product")}).on("change","input.visibility_cart",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[t].toggled_visibility("cart")}).on("change","input.visibility_order",function(){var t=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[t].toggled_visibility("order")}).on("click",".subsubsub a",function(t){var e=i(this),n=i(this).closest(".wc-bundled-item").data("bundled_item_id");l[n].section_changed(e),t.preventDefault()}),_.each(function(e){var n=i(this),d="bundled_item_"+e;n.data("bundled_item_id",d),l[d]=new t(n)}),a.sortable({items:".wc-bundled-item",cursor:"move",axis:"y",handle:".sort-item",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(i,t){t.item.css("background-color","#f6f6f6")},stop:function(i,t){t.item.removeAttr("style"),o.triggerHandler("wc-bundled-products-changed")}}),e(),"yes"===wc_bundles_admin_params.is_first_bundle&&(i("select#product-type").val("bundle").change().focus(),setTimeout(function(){i(".bundled_products_tab a").trigger("click")},500)),function(){var t,e=o.find(".sw-expanding-button"),n=i(document.body);e.on("click",function(e){e.stopPropagation(),clearTimeout(t);var n=i(this),d=n.find(".select2-search__field");n.addClass("sw-expanding-button--open"),t=setTimeout(function(){d.focus()},700),r.one("change",function(){n.removeClass("sw-expanding-button--open")})}),n.on("click",".select2-container",function(i){i.stopPropagation()}),n.on("click",function(){e.removeClass("sw-expanding-button--open")})}()});