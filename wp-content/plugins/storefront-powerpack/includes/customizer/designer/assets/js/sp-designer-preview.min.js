!function(a,b){if(a&&a.customize){var c=a.customize;c.SPDesignerPreviewData={webSafeFonts:[]},'undefined'!=typeof _wpCustomizeSPDesignerPreviewSettings&&b.extend(c.SPDesignerPreviewData,_wpCustomizeSPDesignerPreviewSettings),c.SPDesignerPreview={PointClickActive:!1,$activeSelector:'',init:function(){var a=this,b={};c.preview.bind('sp-designer-point-click',function(b){a.PointClickActive=!0===b}),a.setupPointClickUI(),c.each(function(c,d){c.id=d,b[c.id]||a.bindListener(c)&&(b[c.id]=!0)}),c.preview.bind('setting',function(d){var e,f,g;d=d.slice(),e=d.shift(),f=d.shift(),g=c(e),g||(g=c.create(e,f)),g.id||(g.id=e),b[g.id]||a.bindListener(g)&&(b[g.id]=!0,g.callbacks.fireWith(g,[g(),null]))})},bindListener:function(a){return!!a.id.match(/^sp_designer_css_data\[(.+?)]/)&&(a.bind(this.updateCSS),!0)},updateCSS:function(a,d){if(!1===a)return void b(d.selector).removeAttr('style');var e,f,g=this,h=g.get();if(e={'font-size':h.fontSize+h.fontSizeUnit,'letter-spacing':h.letterSpacing+h.letterSpacingUnit,'line-height':h.lineHeight+'px','font-style':'italic'===h.fontStyle?'italic':'normal','font-weight':'bold'===h.fontWeight?700:400,'margin-top':h.marginTop+h.marginTopUnit,'margin-bottom':h.marginBottom+h.marginBottomUnit,'margin-left':h.marginLeft+h.marginLeftUnit,'margin-right':h.marginRight+h.marginRightUnit,'padding-top':h.paddingTop+h.paddingTopUnit,'padding-bottom':h.paddingBottom+h.paddingBottomUnit,'padding-left':h.paddingLeft+h.paddingLeftUnit,'padding-right':h.paddingRight+h.paddingRightUnit,color:h.color,'border-width':h.borderWidth+h.borderWidthUnit,'border-style':h.borderStyle,'border-color':h.borderColor,'border-radius':h.borderRadius+h.borderRadiusUnit,'background-color':h.backgroundColor},'Default'===h.fontFamily||''===h.fontFamily)e['font-family']='inherit';else{if(!_.contains(c.SPDesignerPreviewData.webSafeFonts,h.fontFamily)){var i=h.fontFamily;if(h.fontVariant){i=i+':'+h.fontVariant;var j=parseInt(h.fontVariant,10);_.isNaN(j)||('bold'===h.fontWeight&&700<j?e['font-weight']=j:700>j&&(e['font-weight']=j))}WebFont.load({google:{families:[i]}})}e['font-family']=h.fontFamily}f=[],'underline'===h.textUnderline&&f.push('underline'),'line-through'===h.textLineThrough&&f.push('line-through'),0===f.length&&f.push('none'),f=f.join(' '),e['text-decoration']=f,h.backgroundImage&&h.backgroundImage.url?(e['background-image']='url("'+h.backgroundImage.url+'")',e['background-repeat']=h.backgroundRepeat,e['background-position']=h.backgroundPosition,e['background-attachment']=h.backgroundAttachment):e['background-image']='',b(h.selector).css(e)},addSelector:function(a){var d,e=b(a);d={selector:a,cssProperties:{fontWeight:e.css('font-weight'),fontSize:e.css('font-size'),letterSpacing:e.css('letter-spacing'),lineHeight:e.css('line-height'),fontStyle:e.css('font-style'),textDecoration:e.css('text-decoration'),color:e.css('color'),borderRadius:e.css('border-radius'),borderColor:e.css('border-color'),borderStyle:e.css('border-style'),borderWidth:e.css('border-width'),marginTop:e.css('margin-top'),marginLeft:e.css('margin-left'),marginRight:e.css('margin-right'),marginBottom:e.css('margin-bottom'),paddingTop:e.css('padding-top'),paddingLeft:e.css('padding-left'),paddingRight:e.css('padding-right'),paddingBottom:e.css('padding-bottom'),backgroundColor:e.css('background-color'),backgroundRepeat:e.css('background-repeat'),backgroundPosition:e.css('background-position'),backgroundAttachment:e.css('background-attachment')}},c.preview.send('sp-designer-click-selector',d)},setupPointClickUI:function(){var a,d,e,f,g,h=this;_.each(c.SPDesignerPreviewData.selectorsMap,function(a){b(a.selector).attr('data-sp-element-selector',a.selector),b(a.selector).attr('data-sp-element-title',a.name)}),a=b('<div/>').addClass('sp-element-border sp-element-border-top'),d=b('<div/>').addClass('sp-element-border sp-element-border-bottom'),e=b('<div/>').addClass('sp-element-border sp-element-border-left'),f=b('<div/>').addClass('sp-element-border sp-element-border-right'),b('body').append(a),b('body').append(d),b('body').append(e),b('body').append(f),g=b('<div/>').addClass('sp-element-label'),b('body').append(g);var i=function(){h.$activeSelector='',b('.sp-element-same').remove(),b(h.$activeSelector).css({cursor:'auto'}),a.attr('style',''),d.attr('style',''),e.attr('style',''),f.attr('style',''),g.text('').attr('style','')};b('*').on('click',function(){if(!0===h.PointClickActive&&''!==h.$activeSelector){if(h.$activeSelector.attr('data-sp-element-selector')){var a=h.$activeSelector.data('sp-element-selector');h.addSelector(a),i()}return!1}}),b('[data-sp-element-selector]').hover(function(){var c=this,j=b(c).data('sp-element-selector'),k=b(c).data('sp-element-title'),l=b(c).offset(),m=b(c).outerWidth(),n=b(c).outerHeight();if(!1===h.PointClickActive)return!1;if(''!==h.$activeSelector&&!b(c).is(h.$activeSelector)){if(!h.$activeSelector.has(b(c)))return!1;i()}h.$activeSelector=b(c),0===l.left&&(l.left=2,m-=4),a.css({top:l.top,left:l.left,width:m}),d.css({top:l.top+n,left:l.left,width:m}),e.css({top:l.top,left:l.left-2,height:n+2}),f.css({top:l.top,left:l.left+m,height:n+2}),g.text(k),g.css({top:l.top+n,left:l.left-2,width:m+4,'min-width':g.outerWidth()}),b(j).not(this).each(function(){var a=b(this).offset(),c=b(this).outerWidth(),d=b(this).outerHeight();b('<div/>').addClass('sp-element-same').css({position:'absolute','z-index':'999999',width:c,height:d,top:a.top,left:a.left}).appendTo('body')}),b(this).css({cursor:'pointer'})},function(){i(),b(this).css({cursor:'auto'})})}},c.bind('preview-ready',function(){c.preview.bind('active',function(){c.SPDesignerPreview.init()})})}}(window.wp,jQuery);