var d4plib_media_image,d4plib_shared;!function(m,i,e,a){d4plib_media_image={handler:null,init:function(){wp&&wp.media&&void 0===wp.media.frames.d4plib_media_image_frame&&(wp.media.frames.d4plib_media_image_frame=wp.media({title:d4plib_admin_data.string_media_image_title,className:"media-frame d4plib-mediaimage-frame",frame:"post",multiple:!1,library:{type:"image"},button:{text:d4plib_admin_data.string_media_image_button}}),wp.media.frames.d4plib_media_image_frame.on("insert",function(){var i=wp.media.frames.d4plib_media_image_frame.state().get("selection").first().toJSON();d4plib_media_image.handler&&d4plib_media_image.handler(i)}))},open:function(i,e){d4plib_media_image.handler=i,wp.media.frames.d4plib_media_image_frame.open(),m(".d4plib-mediaimage-frame .media-frame-title h1").html(d4plib_admin_data.string_media_image_title),m(".d4plib-mediaimage-frame .media-frame-toolbar .media-toolbar-primary .media-button-insert").html(d4plib_admin_data.string_media_image_button),e&&m(".d4plib-mediaimage-frame").addClass("hide-menu")}},(d4plib_shared={active_element:null,init:function(){d4plib_media_image.init()},image:function(){m(".d4plib-image-preview").click(function(i){i.preventDefault(),m(this).parent().find("img").slideToggle(function(){m(this).is(":visible")&&m(this).css("display","block")})}),m(".d4plib-image-remove").click(function(i){i.preventDefault(),confirm(d4plib_admin_data.string_are_you_sure)&&(m(this).parent().find(".d4plib-image").val("0"),m(this).parent().find("img").attr("src","").hide(),m(this).parent().find(".d4plib-image-name").html(d4plib_admin_data.string_image_not_selected),m(this).parent().find(".d4plib-image-preview, .d4plib-image-remove").hide())}),m(".d4plib-image-add").click(function(i){i.preventDefault(),d4plib_shared.active_element=m(this).parent(),d4plib_media_image.open(d4plib_shared.handlers.image,!0)})},images:function(){m(e).on("click",".d4plib-images-preview",function(i){i.preventDefault(),m(this).parent().find("img").slideToggle(function(){m(this).is(":visible")&&m(this).css("display","block")})}),m(e).on("click",".d4plib-images-remove",function(i){i.preventDefault(),confirm(d4plib_admin_data.string_are_you_sure)&&(1===m(this).parent().parent().find(".d4plib-images-image").length&&m(this).parent().parent().find(".d4plib-images-none").show(),m(this).parent().remove())}),m(".d4plib-images-add").click(function(i){i.preventDefault(),d4plib_shared.active_element=m(this).parent(),d4plib_media_image.open(d4plib_shared.handlers.images,!0)})},handlers:{image:function(i){var e=d4plib_shared.active_element;m(".d4plib-image",e).val(i.id),m(".d4plib-image-name",e).html("("+i.id+") "+i.name),m("img",e).attr("src",i.url).hide(),m(".d4plib-image-preview, .d4plib-image-remove",e).show()},images:function(i){var e=d4plib_shared.active_element,a=m(e).find(".d4plib-selected-image").data("name"),d=m("<div class='d4plib-images-image'>");d.append("<input type='hidden' value='"+i.id+"' name='"+a+"[]' />"),d.append("<a class='button d4plib-button-action d4plib-images-remove' aria-label='"+d4plib_admin_data.string_media_image_remove+"'><i aria-hidden='true' class='fa fa-ban'></i></a>"),d.append("<a class='button d4plib-button-action d4plib-images-preview' aria-label='"+d4plib_admin_data.string_media_image_preview+"'><i aria-hidden='true' class='fa fa-search'></i></a>"),d.append("<span class='d4plib-image-name'>("+i.id+") "+i.name+"</span>"),d.append("<img src='"+i.url+"' />"),m(".d4plib-selected-image",e).append(d),m(".d4plib-images-none",e).hide()}}}).init(),d4plib_shared.image(),d4plib_shared.images()}(jQuery,window,document);