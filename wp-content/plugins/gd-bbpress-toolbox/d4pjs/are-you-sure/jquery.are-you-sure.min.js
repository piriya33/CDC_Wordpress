/*!
 * jQuery Plugin: Are-You-Sure (Dirty Form Detection)
 * https://github.com/codedance/jquery.AreYouSure/
 *
 * Copyright (c) 2012-2014, Chris Dance and PaperCut Software http://www.papercut.com/
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * Author:  chris.dance@papercut.com
 * Version: 1.9.0
 * Date:    13th August 2014
 */
(function($){$.fn.areYouSure=function(h){var i=$.extend({'message':'You have unsaved changes!','dirtyClass':'dirty','change':null,'silent':false,'addRemoveFieldsMarksDirty':false,'fieldEvents':'change keyup propertychange input','fieldSelector':":input:not(input[type=submit]):not(input[type=button])"},h);var j=function(b){if(b.hasClass('ays-ignore')||b.hasClass('aysIgnore')||b.attr('data-ays-ignore')||b.attr('name')===undefined){return null}if(b.is(':disabled')){return'ays-disabled'}var c;var d=b.attr('type');if(b.is('select')){d='select'}switch(d){case'checkbox':case'radio':c=b.is(':checked');break;case'select':c='';b.find('option').each(function(o){var a=$(this);if(a.is(':selected')){c+=a.val()}});break;default:c=b.val()}return c};var k=function(a){a.data('ays-orig',j(a))};var l=function(c){var d=function(a){var b=a.data('ays-orig');if(undefined===b){return false}return(j(a)!=b)};var e=($(this).is('form'))?$(this):$(this).parents('form');if(d($(c.target))){n(e,true);return}$fields=e.find(i.fieldSelector);if(i.addRemoveFieldsMarksDirty){var f=e.data("ays-orig-field-count");if(f!=$fields.length){n(e,true);return}}var g=false;$fields.each(function(){$field=$(this);if(d($field)){g=true;return false}});n(e,g)};var m=function(a){var b=a.find(i.fieldSelector);$(b).each(function(){k($(this))});$(b).unbind(i.fieldEvents,l);$(b).bind(i.fieldEvents,l);a.data("ays-orig-field-count",$(b).length);n(a,false)};var n=function(a,b){var c=b!=a.hasClass(i.dirtyClass);a.toggleClass(i.dirtyClass,b);if(c){if(i.change)i.change.call(a,a);if(b)a.trigger('dirty.areYouSure',[a]);if(!b)a.trigger('clean.areYouSure',[a]);a.trigger('change.areYouSure',[a])}};var p=function(){var b=$(this);var c=b.find(i.fieldSelector);$(c).each(function(){var a=$(this);if(!a.data('ays-orig')){k(a);a.bind(i.fieldEvents,l)}});b.trigger('checkform.areYouSure')};var q=function(){m($(this))};if(!i.silent&&!window.aysUnloadSet){window.aysUnloadSet=true;$(window).bind('beforeunload',function(){$dirtyForms=$("form").filter('.'+i.dirtyClass);if($dirtyForms.length==0){return}if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted){return}window.aysHasPrompted=true;window.setTimeout(function(){window.aysHasPrompted=false},900)}return i.message})}return this.each(function(a){if(!$(this).is('form')){return}var b=$(this);b.submit(function(){b.removeClass(i.dirtyClass)});b.bind('reset',function(){n(b,false)});b.bind('rescan.areYouSure',p);b.bind('reinitialize.areYouSure',q);b.bind('checkform.areYouSure',l);m(b)})}})(jQuery);
